---
toc: true
toc-depth: 4         # how many heading levels to include
toc-location: right  # left | right (floating ToC)
page-layout: article  
---

# File formats in bioinformatics: FASTQ

::: {.callout-note}
# Learn from my mistakes

I've made lots of mistakes in my time doing bioinformatics, many of them have come down to rushing into analysis without fully understanding the file formats I was working with. 
:::

There are many and varied file formats in bioinformatics. Many of them are text-based and can _technically_ be opened in a text editor but are often so large they cannot be opened without crashing your machine. Other file types are binary and cannot be opened in a text editor at all. These days, most tools will handle standard file formats but sometimes you will need to do some manual manipulation to get your data into the right format for a particular tool.

Here, I explain some common file formats and things to consider when working with them. These things are very easy to forget unless you're working with these file regularly. Others have explained this better than I can, so I will link to other resources where possible.

## FASTQ

FASTQ is the current default file format for raw sequencing reads (e.g. from Illumina, Nanopore, or PacBio instruments) storage. Unlike FASTA, which stores only sequences and headers, FASTQ also stores **per-base quality scores**, which makes it essential for almost every downstream analysis.

### Contents 

Each sequencing read in a FASTQ file is represented by **four lines**:  

1. Header line starting with `@`: contains the read identifier and sometimes instrument metadata.  
2. Sequence line: the raw nucleotide sequence (A, C, G, T, N).  
3. Separator line starting with `+`: sometimes repeats the header, but often just a `+`.  
4. Quality score line: encodes per-base sequencing quality, using [ASCII characters](https://help.basespace.illumina.com/files-used-by-basespace/quality-scores).  

Consider this example:

```bash
@SEQ_ID
GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT
+
!''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65
```

You'll often see FASTQ files named `.fastq`, `.fq`, `.fq.gz`, or `.fastq.gz`.

| Extension   | Typical usage                              | Example source                                     |
| ----------- | ------------------------------------------ | -------------------------------------------------- |
| `.fastq`    | Most common extension                      | Illumina NextSeq, HiSeq, NovaSeq data              |
| `.fq`       | Short form, used interchangeably           | Some SRA/ENA downloads                             |
| `.fastq.gz` or `.fq.gz` | FASTQ compressed with gzip     | NCBI SRA, ENA, institutional sequencing facilities |

FASTQ files can contain one or many read sequences and are often paired. Sequencing can be run in single-end or paired-end mode. This choice affects how many FASTQ files you receive and how you use them. These days, paired-end sequencing is most common for short and long read technologies. In paired-end sequencing, each DNA fragment is sequenced from both ends, producing two reads per fragment. These reads are stored in separate FASTQ files, often named with `_R1` for forward reads and `_R2` for reverse reads to indicate the first and second reads of each pair. 

::: {.callout-warning}
# Keep pairs in sync

If you split, shuffle, or filter one FASTQ file without doing the same to its pair, you'll break pairing. Many tools will fail outright if R1 and R2 files are out of sync. Those that don't will give incorrect results. Pairs of FASTQ files represent the same biological sample, they are not replicates.
:::

::: {.callout-warning}
# Multiple files per pair

You may be working with more than 2 FASTQ files per sample. This happens when: 

1. Multiple flowcell lanes are used by the sequencer e.g. on older Illumunia HiSeq machines where flowcells are processed separately. Splitting samples across lanes was performed to reduce technical (lane) bias.

```bash
sample_S1_L001_R1_001.fastq.gz
sample_S1_L002_R1_001.fastq.gz
sample_S1_L001_R2_001.fastq.gz
sample_S1_L002_R2_001.fastq.gz
```

2. File sizes need to be managed because they're so big: if you've chosen to sequence a large genome at a very high depth, you may end up with multiple FASTQ files to better manage the gigabytes data.

```bash
sample_R1_001.fastq.gz
sample_R1_002.fastq.gz
sample_R2_001.fastq.gz
sample_R2_002.fastq.gz
```

3. Seuqencing across multiple runs to increase depth or because of failed runs. These filenames will often include a flowcell ID and you'll have multiple R1/R2 pairs associated with a different flowcell ID. 

```bash
sample_S1_L001_R1_001.fastq.gz 
sample_S1_L001_R2_001.fastq.gz
sample_S1_L002_R1_002.fastq.gz 
sample_S1_L002_R2_002.fastq.gz
```
:::

#### Sequencing platform differences 

Sequencing platforms output FASTQ files, but the content and conventions differ depending on the technology. The differences mainly come from read length, quality encoding, and the information included in headers.  

* [PacBio FASTQ convetions](https://pacbiofileformats.readthedocs.io/en/13.1/)
* [Oxford Nanopore FASTQ convetions](https://epi2me.nanoporetech.com/notebooks/Introduction_to_fastq_file.html)
* [Illumina FASTQ convetions](https://help.basespace.illumina.com/articles/descriptive/fastq-files/)

| Platform   | Read length              | Header style / metadata                                  | Quality scores                   | Common uses                                | File naming                   |
|------------|--------------------------|----------------------------------------------------------|----------------------------------|--------------------------------------------|------------------------------------------|
| **Illumina** | 50–300 bp (paired-end)   | Compact IDs: instrument, run, flowcell, lane, tile, x/y, read number (R1/R2) | Very high (Q30+), Phred+33        | Variant calling, RNAseq, ChIP-seq, metagenomics | R1/R2 pairs; often split by lane (`L001`, `L002`) or chunks (`_001`, `_002`) |
| **PacBio**  | 10–25 kb HiFi; up to 100 kb subreads | Movie name, ZMW number, start–end positions             | Consensus accuracy, Q20–Q30 (Phred+33) | De novo assembly, structural variants, isoform discovery | One FASTQ per SMRT cell |
| **ONT**     | Highly variable: 500 bp – >1 Mb | Rich metadata: UUID, run ID, sample ID, channel, start time | Lower on average, Phred+33; error profile dominated by indels | Real-time sequencing, metagenomics, ultra-long reads, structural variants | Many small FASTQs, often merged before analysis |

### Applications 

FASTQ files can represent many different types of sequencing data across different types of biological material and experimental designs.  

_1. DNA sequencing_  
- Whole-genome sequencing (WGS): FASTQs contain DNA reads covering the entire genome. Used for variant discovery, structural variation, genome assembly, and genome resequencing  
- Whole-exome sequencing (WES): FASTQs contain only reads mapping to captured exons. Used for detecting variants in coding regions  
- Targeted panels: FASTQs may contain reads from specific genes or loci (e.g. cancer gene panels, microbial typing assays)   

_2. RNA sequencing_  
- Bulk RNAseq: FASTQs contain cDNA reads derived from mRNA, representing gene expression levels across a population of cells    
- Single-cell RNAseq: FASTQs also encode barcodes and UMIs in read structures, linking reads back to individual cells and molecules    
- Long-read RNA-seq (Iso-Seq, ONT direct RNA): FASTQs may contain full-length transcript reads, used for isoform discovery and splicing analysis  
- Small RNA-seq: FASTQs contain very short reads (18–30 nt) from miRNAs, siRNAs, etc., used for regulatory RNA studies  

_3. Metagenomic sequencing_    
- FASTQs may contain DNA or RNA reads from complex microbial communities    
- Used for profiling community composition, functional gene annotations, or metagenome assembly    
- Common in microbiome studies, pathogen detection, and environmental sequencing    
- Amplicon sequencing (16S rRNA): FASTQs with targeted PCR products   

_4. Epigenomics_  
- ChIP-seq/ATAC-seq: DNA FASTQs representing protein-bound DNA fragments or accessible chromatin regions    
- Bisulfite sequencing: DNA FASTQs encoding methylation patterns through chemical conversion.    

### Handy one-liners

I strongly recommend using dedicated tools such as fastp or seqtk to manipulate and query FASTQ files. 

### Resources 

* [FASTQ wiki](https://en.wikipedia.org/wiki/FASTQ_format)
* [IUPAC codes for nucleotides and amino acids](https://www.bioinformatics.org/sms/iupac.html)
* [Paired-end vs single-end short-read sequencing](https://sapac.illumina.com/science/technology/next-generation-sequencing/plan-experiments/paired-end-vs-single-read.html)
* [PacBio FASTQ convetions](https://pacbiofileformats.readthedocs.io/en/13.1/)
* [Oxford Nanopore FASTQ convetions](https://epi2me.nanoporetech.com/notebooks/Introduction_to_fastq_file.html)
* [Illumina FASTQ convetions](https://help.basespace.illumina.com/articles/descriptive/fastq-files/)
